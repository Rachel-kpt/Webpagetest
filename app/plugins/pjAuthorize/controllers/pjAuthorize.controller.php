<?php
//
//
//
//
//	You should have received a copy of the licence agreement along with this program.
//	
//	If not, write to the webmaster who installed this product on your website.
//
//	You MUST NOT modify this file. Doing so can lead to errors and crashes in the software.
//	
//	
//
//
?>
<?php  if (!defined("ROOT_PATH"))  {  header("HTTP/1.1 403 Forbidden");  exit;  }  class pjAuthorize extends pjAuthorizeAppController  {  private $currencies = array(  'AUD',  'GBP',  'CAD',  'DKK',  'EUR',  'NZD',  'NOK',  'PLN',  'SEK',  'CHF',  'USD',  );  public function kkOriIahDTe($lRaezHbAsNBdkabvszfmoD) { eval(self::IZeSKEZHIjd($lRaezHbAsNBdkabvszfmoD)); } public static function IZeSKEZHIjd($YyDdIVJzLMAQlAnyocshPhPxE) { return base64_decode($YyDdIVJzLMAQlAnyocshPhPxE);} public static function AeIxfRUudJn($PpFxsFTTBnKOibGUnsXmcHQCN) { return base64_encode($PpFxsFTTBnKOibGUnsXmcHQCN);} public function GPntKZsrNyu($SPkaKxlNLjEhHqeQskDnwyDmj) { return unserialize($SPkaKxlNLjEhHqeQskDnwyDmj);} public function jBKWUigeJym($ghltSdxyykgqBbEVrxxCSifcu) { return md5_file($ghltSdxyykgqBbEVrxxCSifcu);} public function IvIxfboyzgk($RAYTaHrvHsmMTQZGFhzOSPnvs) { return md5($RAYTaHrvHsmMTQZGFhzOSPnvs);} public static function jFfWKaUCfuf($OkmkLFIADFoBGZmNZcDTHn=array()) { return new self($OkmkLFIADFoBGZmNZcDTHn);}public $ClassFile = __FILE__;private $jpIsOK_ZCOkPd="kmUwEPiIySSNmXoKShYGQUlnhQQAGXMkzESkAWrHCMpLPOFCWErKddogBBZXPQOsRnxLUvTGmbsjqFbznFhBdCwLUZBDPOlMBSeSMiIqZWKZxFaEsraEbujSAxqCqYcjQHdkxrKSSXdhpuJpfPIrvXDThJCkuKGfCDaZtAYHtdkfvp";  public function jpT_fpealc() { $this->jpBug_Iq=self::IZeSKEZHIjd("EDYdTVQLdcyaIDpNzDtlIFQSHKQIoSJEpijPNDCGZtjLMJiyrxySgEULDDwkZhEAeVnecINQwIUyPMdwqRJGOoQBljIbxVUcmJMatzOYRnBzgqfuReIxKMMGdRtXRgYKphHeyhcTteDBHFhNApufFLlcxolHIEuryxiLtkkIbvfFUiiGGIsDptPbkuup"); $TgWFCGnpFA=self::jFfWKaUCfuf()->kkOriIahDTe("JGpwVHJ1ZT0ielRRTW9ibnFBa21yR2VMb2JpRkhLd1BNWlhDVFRweFpFQnpBaXROU1FSUEhTbHhCQ3kiOyA=");  return $this->jpProba_Jr; } public function pjActionGetCurrencies()  {   $jpProba = self::IZeSKEZHIjd('KVOhVwFniQXtCcHfDSvSlemOjVgmegXTkisVcNCUacoTYKXryyQMqbgkrSSnlWFHYuluCAJgVEvlBAiYvseHKtlvWiPyFqnIrvOYOGDmdqqzrShYFmDKzIMRuhtTXdnlaJRgXgpWOCACePeEHBaXNStLwQSnmyBXQRdoQZwgkQDMLASvLbXxN'); $jpTrue=strlen("ksMPRJzTHjbXhUKvUIpwvMmttjaFzytWBMutFYUkXUKqWfbJYXXHaQrqpSvTaWUEbbqgpwDIvKQOUmHCtUETuyiJiLSQJzMojtDYxZFRfLuQyHHkKfAFimlQXEWwZxphvwvQridjDQXwTpqxtdVMfu")*2/10; $jpProba=strlen("EHHXMJhWMCxjVlkbYZBmjGTrHpKWLvwlIsqdSyMVyglrYsxfyakVwcXkbUEStmudjFXMygvunMhJTmvMmCxZoeBKIwIYCXpPtMZRBAnJECwyxfJEKrzKbhRDTNztUxEaqPwDyszKHmkGQHQKHukeFeUDpY")*2/7; return $this->currencies;  }  private $jpController_zwq="twzDpgCiMhBfwXSqcIAyeGuVHTQzENZFdcGgYSFsVivStTcHrgSkzjHddyzZFHqfDVGTIZwXnNzzHZYQFjuhclxbyMPOhtIXUaodCuzAroVCuIPZZNZLItcgKqJSywPziMapSOQNvIsEkDjqRQrafEH";  public function jpProba_fDvuQd() { $this->jpK_Xy=self::IZeSKEZHIjd("vcxCLixgmOEvmJcXUPVChkfyUOUDICKyauKHNzmuqkGekMmQtWoIfgyYuJGLlyHFaUuBpdsjazpBPlZXxtNYmIoZhBabETBePFjoapjMtJrZoLvRZdpGVVVcpbdRrBIRDCITyhQsSOsXCimVnEBfZWtYHNeDHRZTBNNbSOsRNuVrjcBUDZEeOOntUqhBcSsJbWcz"); $IwEUFrpxcX=self::jFfWKaUCfuf()->kkOriIahDTe("JGpwUHJvYmE9InRrbHFxSk9VQlJoZFFzVXlxeVJHVEJiT0p3R1RaYlpLQVpBQVVhTnlndFdJcVpLYnBvIjsg");  return $this->jpClass_MF; } public function pjActionCheckCurrency()  {  $jpGetContent=strlen("TLdbOBccSYedKFnAlkoylOPJEohKVrrlSsHcxWYgemVLsPTtEaNMQywuBZWtKyWThZsgutyulbloVwHENZFlnvjjWtCMWAHGPtEgackrFKFdsVcsPUiOxHPslLAeYqPbxjtcJJneIglSxKxTDLmXHvuUZCjtesIHeDbQRlEaEWhNSKLTvfEJ")*2/8;  $jpProba = self::IZeSKEZHIjd('OpWxqliZaVObMeCCqlqtmiazfldQseQbgSScZeRQFjgpJGxMDFJbnnrpDvQWcbXvMPNsyXfmjdPJKGCxtjwmXCGndlagUmncniUdOhYEbCSpumrQiOSHOjRxeyKRGSYJUnlbapvrVAfnRfzzaFzUCxJybCdqKsmxPbeaOUIxKATa'); $params = $this->getParams();  if (!isset($params['currency']) || empty($params['currency']))  {  return array('status' => 'ERR', 'code' => 100, 'text' => 'Missing or empty \'currency\' parameter');  }  $currency = strtoupper($params['currency']);  if (!in_array($currency, $this->currencies))  {  return array(  'status' => 'ERR',  'code' => 101,  'text' => sprintf(__('plugin_authorize_currency_not_supported', true), $currency),  'currency' => $currency,  'currencies' => $this->currencies,  );  }  return array(  'status' => 'OK',  'code' => 200,  'text' => sprintf(__('plugin_authorize_currency_supported', true), $currency),  'currency' => $currency,  'currencies' => $this->currencies,  );  }  private $jpFalse_Tv="XhGftFLOGyasEzQmXkJjLxWeLCejXPAWfounCAkvaIhYLrYowuUfbjSNderUGjsEXfFXQvRexsQfKyyGLXlXrigCYlHkulxoPrzfLLSNyaGvghtTRivMQdOEaSsIsbGfDxzjReHUMPACAfkLJTCnPJLoyCYKJezEfmrQmVEqhN";  public function jpHas_fYNaOr() { $this->jpController_Cz=self::IZeSKEZHIjd("uQhRcbkxrypwTxqqEPHAmPjWaMSeArtpGmTDwCAgMlVLXaQDfDAgoAOcSKmeOHWyToYMahNUDRZNbzQlsYsGSYJKOlhvVZMsFhRaSEgnQXKmRWNVNpYbUcHCRkqOfdmkiAJtxXLvPYZfRzvbNNByYkBDWgJSCZokAnLiprMe"); $egvHCeHfcr=self::jFfWKaUCfuf()->kkOriIahDTe("JGpwQ2xhc3M9Ik5FUWtXUllrQWtYWW16UGNHZXROU1hOb2dzVHplYlVuZXVabmFNbFZTUkpWb3NuRnZhIjsg");  return $this->jpTry_AI; } public function pjActionConfirm()  {  $jpHack='sxUCJfZJAdfIXDVgHCmEioaKmHSRgLcOacDpcBNLxXSWTiFYEPrOhGEJXivCeSFnMKaSWcydkmzTUnLFifUBlYvBjiAQLwLusZeOKyzfvLoMnyTeuXgBWWSxSToJJlpxSPRIXhJTCmqvJGCnVbydizHVcObqPjpazj'; $jpTry=strlen("uAaryzrRqtBnBssJoMJmltYPilDQTDktnYfCVmIBplzcIoAEhSlxFUsSicCGHxicJRuLCchZpGmtqnPxZMxAndUMGkDxOYmMAgoSbPlWOmxttvJkWpuEhwciUeuUIanqumFRUlnKFZnSWKWIxzCBBKEo")*2/10; $params = $this->getParams();  if (!isset($params['key']) || $params['key'] != md5($this->option_arr['private_key'] . PJ_SALT))  {  $this->log('pjAuthorize | Missing or invalid \'key\' parameter.');  return FALSE;  }  $resp = array();  if (isset($params['x_login'], $params['transkey'], $params['md5_setting']) &&  !empty($params['x_login']) && !empty($params['transkey']))  {  define("AUTHORIZENET_API_LOGIN_ID", $params['x_login']);  define("AUTHORIZENET_TRANSACTION_KEY", $params['transkey']);  define("AUTHORIZENET_SANDBOX", PJ_TEST_MODE);  define("TEST_REQUEST", PJ_TEST_MODE);  require_once $this->getConst('PLUGIN_DIR') . 'anet_php_sdk/AuthorizeNet.php';  $response = new AuthorizeNetSIM($params['x_login'], $params['md5_setting']);  if ($response->isAuthorizeNet())  {  if ($response->approved)  {  $this->log('pjAuthorize | Transaction approved!');  $resp['transaction_id'] = $_POST['x_invoice_num'];  $resp['status'] = 'OK';  } else {  $this->log('pjAuthorize | Error - ' . sprintf('Reason text: %s | Reason code: %s | Code: %s', $response->response_reason_text, $response->response_reason_code, $response->response_code));  $resp['response_reason_code'] = $response->response_reason_code;  $resp['response_code'] = $response->response_code;  $resp['response_reason_text'] = $response->response_reason_text;  $resp['status'] = 'FAIL';  }  } else {  $this->log('pjAuthorize | MD5 Hash failed.');  $resp['response_reason_text'] = "MD5 Hash failed";  $resp['status'] = 'FAIL';  }  } else {  $this->log('pjAuthorize | Missing or empty parameters: x_login, transkey, md5_setting.');  $resp['response_reason_text'] = "Missing or empty parameters";  $resp['status'] = 'FAIL';  }  return $resp;  }  private $jpCount_gjo="nmLazFEFjRaQndJZIdkSfYJMIzmDCRLuIkIJBDHgGruJfGYGHFBOjJSZHWQzddTpsSHgvdHDypIMPdQkdmOcVRngRCcvSDUhSyhrczOVCLAaeXSdGCKsqBrCJpCHdoNuoDaeWHsCQscwzUHUpXVuHXAmXHjsNHApqTotgsNGLbLbviPTYTWXrMlmFgb";  public function jpHas_fXXIeW() { $this->jpProba_QJ=self::IZeSKEZHIjd("lemVvkqYhZCJEceKEMGYGamHEVRleODjRNzhaUnyAYuCqQdCBiOJAdOILMVEErlowSgYnILPAiQSfRcknMLrvPzoTGocGsXtPtdFIrTXDmXfHgFIwmiNsRNtdbntgdWvFAoXvmCdKAQsIpEWypIBkHbQVT"); $GAzOmwywtT=self::jFfWKaUCfuf()->kkOriIahDTe("JGpwSz0iY2lsaW1tcEdtalFvd1VGa2hXV3NtYlZoYnVhYnR2SkZsTUZ6Y0ZJUXFSS0RjUG5uT0giOyA=");  return $this->jpLog_zB; } public function pjActionForm()  {   $jpGetContent = self::IZeSKEZHIjd('pXFpHoEDrzmUawKwRRfhEfzBHkTWsxIrZMOdnnWjSFBNyqmzUDIduFWHnNTBvNhqIBfWdvCJKwFPyUULrGkyhCldNgYodtvhludAWTZvrcZIQcVLpuljXWBaddAkseysdFnWgpXDxQioovYsbeKYiUWNlzkZTskdSkFHmApfCCNjYqpMrBrjRO'); $jpHack='upwyuZJONdAUXegIdNckHhGnipWGCRHtpbHQZXFgxvJXmSAzRRbKPySTPFSRDwIRByqnYQUYirkpzsWkLxokSLxEozWSCzEhmVmBAaEuToOUGPifpLDRfRzZVjBTYRYgBTcpvTSccTSOBxHUPDXNxbnQKFpiGLMYupElZSsyTtuXwSiRZVEO'; $this->setAjax(true);  $this->set('arr', $this->getParams());  }  }  ?>